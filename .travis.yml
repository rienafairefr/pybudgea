language: python
sudo: required
addons:
  apt:
    sources:
      - deadsnakes
    packages:
      - python3.5
services:
- docker
python:
- 3.6
- 3.5
- 3.4
- 2.7
install:
- pip install pipenv
- pipenv install --dev
- make api
script:
- pipenv run pytest --cov=api
- pipenv run coveralls
after_success:
- make deploy_pypi
deploy:
  provider: releases
  api_key:
    secure: kb284kwbZuRlWeeNjVyQ5ieVgl0PcHPRCM3oiUn2tKp/jIy928HuhYCeuhanomh5bFLac+9Ug1BQWF8cl4MV2oOz9mJWoCmrCg0yL+tGLDVOoEHzveC4FAGKs3aeGbX1Zf7WimgHUiVyBJer3Ou0SS15mWHyJ8OowneyYaCjZBUisn7+D9Qnxn5ZecZVsvs0vW5kBFl9+AI+ivg0hiwBGeG+4Rh3s2q/MBqOjEY4Dv5o7SJ1Y6xtlMXFjcjpAm1g8Gcsd92T9XopsZGxKnVWDoAr2HMZcZaCbf/lfFno6yiXPcTvLOwbe9s+pYUqkNky6MIPvrQNpUiVDLxSHO38pqKFgoTJppPWFPyxzHUsNKRN/BedH7NwNCN05beNyPSefEB/lpTYWB/Io97b8GHVTzPkitFvU7jrGemWL9lMLotVfRMW72CGIO25t5yX+PlGXPgYcebMnLL5tggZI+9vcOtO3bSVVFTKz16Bq30mMMSI+WkvqZnFhs2+e7fdzr66wcngitbniF2QE5ohPK6NKnGxUKgirjCWxHxAlzYrJOqGvZp0hGQF923d2a1hxj1XlG3uVmE5VUeuulZ/QfRTXJHayqqLl/mmx9d6ggWyqki3uo5O+rNViYxSr2McA5O52qDEbX9+a+KZ7qrk0aTFybl8AMIR1JZSLWKXY9U5t1A=
  file_glob: true
  file:
    - dist/*
  on:
    repo: rienafairefr/pybudgea
    tags: true
